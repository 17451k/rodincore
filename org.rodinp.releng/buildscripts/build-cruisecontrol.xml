<project name="build-eclipse" default="product-build" >

<target name="product-build" depends="clean,get-dependencies">

    <java jar="${baseLocation}/plugins/org.eclipse.equinox.launcher_1.0.101.R34x_v20081125.jar"
          fork="true">
      <arg line="-Dbuilder=${buildFolder}/${projectName}/buildscripts"/>
      <arg line="-application org.eclipse.ant.core.antRunner"/>
      <arg line="-buildfile ${baseLocation}/plugins/org.eclipse.pde.build_3.4.1.R34x_v20081217/scripts/productBuild/productBuild.xml"/>

      <arg line="-DbaseLocation=${baseLocation}"/>
      <arg line="-DbuildDirectory=${buildFolder}/${projectName}"/>
      <arg line="-DbuildFolder=${buildFolder}/${projectName}/buildscripts"/>
      <arg line="-DprojectName=${projectName}"/>
      <arg line="-DpluginPath=${pluginPath}"/>
      <arg line="-Dcruisecontrol=true"/>
    </java>

</target>

<target name="get-dependencies">
<mkdir dir="${buildFolder}/${projectName}/dependencies" />

<unzip src="${buildFolder}/org.rodinp/I.cruise/org.rodinp-cruise.zip"
       dest="${buildFolder}/${projectName}/dependencies">
</unzip>
<unzip src="${buildFolder}/org.eventb.ide/I.cruise/org.eventb.ide-cruise.zip"
       dest="${buildFolder}/${projectName}/dependencies">
</unzip>

</target>

<target name="clean">
  <delete>
    <fileset dir="${buildFolder}/${projectName}/" includes="assemble.org.*"/>
    <fileset dir="${buildFolder}/${projectName}/" includes="finalFeaturesVersions.*"/>
    <fileset dir="${buildFolder}/${projectName}/" includes="package.org.eclipse.pde.build.container.*"/>
  </delete>
  <delete dir="${buildFolder}/${projectName}/repo" />
  <delete dir="${buildFolder}/${projectName}/result" />
  <delete dir="${buildFolder}/${projectName}/dependencies" />

</target>

</project>
